// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model BonusListItem {
  id         Int      @id @default(autoincrement())
  icon       String
  img        String   @default("")
  title      String
  desc       String   @default("")
  price      Float    @default(0)
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model HadistListItem {
  id         Int      @id @default(autoincrement())
  noHadist   Int      @default(0)
  title      String
  desc       String   @default("")
  sanad      String   @default("")
  category   String   @default("")
  quotes     String   @default("")
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model InterestListItem {
  id         Int      @id @default(autoincrement())
  icon       String
  title      String
  desc       String
  img        String   @default("")
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model AlurListItem {
  id         Int      @id @default(autoincrement())
  icon       String
  title      String
  desc       String
  img        String
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model BenefitListItem {
  id         Int      @id @default(autoincrement())
  icon       String
  title      String
  desc       String
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model DidapatkanListItem {
  id         Int      @id @default(autoincrement())
  icon       String
  title      String
  desc       String
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model SkillListItem {
  id            Int      @id @default(autoincrement())
  icon          String
  title         String
  desc          String
  createDate    DateTime @default(now())
  updateDate    DateTime @updatedAt
  landingPageId Int
}

model SolutionListItem {
  id            Int      @id @default(autoincrement())
  icon          String
  title         String
  desc          String
  createDate    DateTime @default(now())
  updateDate    DateTime @updatedAt
  landingPageId Int
}

model FeatureServicesListItem {
  id                 Int              @id @default(autoincrement())
  title              String
  isActive           Boolean          @default(false)
  createDate         DateTime         @default(now())
  updateDate         DateTime         @updatedAt
  servicesListItemId Int
  servicesListItem   ServicesListItem @relation(fields: [servicesListItemId], references: [id], onDelete: Cascade)
}

model ServicesListItem {
  id                      Int                       @id @default(autoincrement())
  title                   String
  desc                    String
  sku                     String                    @default("")
  icon                    String
  img                     String                    @default("")
  slug                    String?                   @unique
  price                   Float
  quality                 Int                       @default(0)
  stock                   Int                       @default(0)
  isBest                  Boolean                   @default(false)
  category                Int                       @default(0)
  featureServicesListItem FeatureServicesListItem[]
  servicesGalleryListItem ServicesGalleryListItem[]
  metaData                MetaData?
  createDate              DateTime                  @default(now())
  updateDate              DateTime                  @updatedAt
}

model MetaData {
  id          Int               @id @default(autoincrement())
  slug        String            @unique
  title       String
  desc        String
  keywords    String
  author      String            @default("")
  ogImage     String?
  category    String            @default("")
  index       Boolean           @default(false)
  follow      Boolean           @default(false)
  service     ServicesListItem? @relation(fields: [serviceId], references: [id])
  landingPage LandingPage?      @relation(fields: [pageId], references: [id])
  serviceId   Int?              @unique
  pageId      Int?              @unique
  createDate  DateTime          @default(now())
  updateDate  DateTime          @updatedAt
}

model ServicesGalleryListItem {
  id                 Int              @id @default(autoincrement())
  title              String
  img                String           @default("")
  servicesListItemId Int
  servicesListItem   ServicesListItem @relation(fields: [servicesListItemId], references: [id], onDelete: Cascade)
  createDate         DateTime         @default(now())
  updateDate         DateTime         @updatedAt
}

model ServicesCategory {
  id         Int      @id @default(autoincrement())
  title      String   @default("")
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model LandingPage {
  id                  Int       @id @default(autoincrement())
  benefitBtnTxt       String    @default("")
  benefitDesc         String    @default("")
  benefitListTitle    String    @default("")
  benefitImg          String    @default("")
  benefitTitle        String    @default("")
  bonusBtnTxt         String    @default("")
  bonusCounter        DateTime  @default(now())
  bonusDesc           String    @default("")
  bonusPrice          Float     @default(0)
  bonusTitle          String
  cta1BtnTxt          String    @default("")
  cta1Desc            String    @default("")
  cta1Img             String    @default("")
  cta1Title           String    @default("")
  cta2BtnTxt          String    @default("")
  cta2Desc            String    @default("")
  cta2Img             String    @default("")
  cta2Title           String    @default("")
  cta3BtnTxt          String    @default("")
  cta3Desc            String    @default("")
  cta3Img             String    @default("")
  cta3Title           String    @default("")
  didapatkanBtnTxt    String    @default("")
  didapatkanDesc      String    @default("")
  didapatkanListTitle String    @default("")
  didapatkanImg       String    @default("")
  didapatkanTitle     String    @default("")
  heroBtnTxt          String    @default("")
  heroDesc            String    @default("")
  heroImg             String    @default("")
  heroTitle           String    @default("")
  interestBtnTxt      String    @default("")
  interestDesc        String    @default("")
  interestListTitle   String    @default("")
  interestImg         String    @default("")
  interestTitle       String    @default("")
  manfaatBtnTxt       String    @default("")
  manfaatDesc         String    @default("")
  manfaatListTitle    String    @default("")
  manfaatImg          String    @default("")
  manfaatTitle        String    @default("")
  metaData            MetaData?
  scoreBtnTxt         String    @default("")
  scoreDesc           String    @default("")
  scoreImg            String    @default("")
  scoreTitle          String    @default("")
  servicesBtnTxt      String    @default("")
  servicesDesc        String    @default("")
  servicesImg         String    @default("")
  servicesTitle       String    @default("")
  skillBtnTxt         String    @default("")
  skillDesc           String    @default("")
  skillImg            String    @default("")
  skillTitle          String    @default("")
  solutionBtnTxt      String    @default("")
  solutionDesc        String    @default("")
  solutionImg         String    @default("")
  solutionTitle       String    @default("")
  createDate          DateTime  @default(now())
  updateDate          DateTime  @updatedAt
}

model RegisterForm {
  id          Int      @id @default(autoincrement())
  name        String
  type        String
  placeholder String
  position    Int      @default(0)
  row         Int      @default(0)
  options     String? // JSON atau comma-separated value untuk radio/select
  required    Boolean  @default(false)
  hint        String? // teks keterangan di bawah input
  hintTrue    String   @default("")
  hintFalse   String   @default("")
  isActive    Boolean  @default(true)
  createDate  DateTime @default(now())
  updateDate  DateTime @updatedAt
}

model ApiList {
  id         Int      @id @default(autoincrement())
  name       String
  createDate DateTime @default(now())
  updateDate DateTime @updatedAt
}

model FacebookPixel {
  id           Int      @id @default(autoincrement())
  pixelId      String // Facebook Pixel ID
  campaignName String // Nama event yang terjadi
  createdAt    DateTime @default(now()) // Waktu data dimasukkan
  updatedAt    DateTime @updatedAt // Waktu data terakhir diperbarui
}

model SocialLinks {
  id               String       @id @default(cuid())
  platform         String?
  url              String?
  platformUsername String?
  identity         SiteIdentity @relation(fields: [identityId], references: [id])
  identityId       String       @default("")
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @default(now()) @updatedAt
}

model SiteIdentity {
  id          String        @id @default(cuid())
  siteName    String
  tagline     String?
  logoUrl     String        @default("")
  faviconUrl  String        @default("/favicon.ico")
  email       String?
  phone       String?
  address     String?
  socialLinks SocialLinks[]
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
}

model Page {
  id            String    @id @default(cuid())
  slug          String    @unique
  name          String
  title         String
  description   String?
  keywords      Json? // <-- diubah dari String[]
  ogTitle       String?
  ogDescription String?
  ogImage       String?
  sections      Section[]
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
}

model Section {
  id          String      @id @default(cuid())
  page        Page        @relation(fields: [pageId], references: [id])
  pageId      String
  type        SectionType
  title       String
  subTitle    String?
  description String?
  image       String?
  video       String?
  icon        String?
  order       Int // untuk pengurutan section
  listItems   ListItem[]
}

model ListItem {
  id          String       @id @default(cuid())
  section     Section      @relation(fields: [sectionId], references: [id])
  sectionId   String
  type        ListItemType
  title       String
  description String?
  icon        String?
  entries     ListEntry[] // ganti items jadi relasi
}

model ListEntry {
  id          String   @id @default(cuid())
  listItem    ListItem @relation(fields: [listItemId], references: [id])
  listItemId  String
  title       String
  description String? // hanya untuk DETAILED
}

enum SectionType {
  NORMAL
  HERO
  IMAGE
  VIDEO
  LIST
  CTA
  CUSTOM
}

enum ListItemType {
  BASIC // hanya title, icon, items
  DETAILED // dengan description
}

model Product {
  id            String                @id @default(cuid())
  sku           String                @unique
  name          String
  slug          String                @unique
  description   String?
  image         String?
  price         Float
  inStock       Boolean               @default(true)
  status        ProductStatus         @default(ACTIVE)
  categoryId    String
  keywords      Json?
  quality       Int
  isBest        Boolean               @default(false)
  category      Category              @relation(fields: [categoryId], references: [id])
  tags          Tag[]                 @relation("TagsOnProducts")
  gallery       ProductGallery[]
  benefits      ProductBenefit[] // Relasi ke Benefit (status aktif/tidak aktif)
  benefitPoints ProductBenefitPoint[]
  promotions    Promotion[]           @relation("ProductPromotions")
  vouchers      Voucher[]             @relation("VoucherProducts") // ✅ Produk yang bisa pakai voucher ini
  orders        Order[]               @relation("OrderProducts")
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
}

model Tag {
  id       String    @id @default(cuid())
  name     String
  slug     String    @unique
  products Product[] @relation("TagsOnProducts")
}

model Category {
  id        String    @id @default(cuid())
  name      String
  slug      String    @unique
  products  Product[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

enum ProductStatus {
  ACTIVE // Produk tersedia dan aktif
  SUSPENDED // Produk dihentikan sementara
  INACTIVE // Produk tidak tersedia
}

model Menu {
  id        String   @id @default(cuid())
  title     String
  slug      String
  type      MenuType
  order     Int
  icon      String?
  parentId  String? // 👈 submenu akan isi ini
  parent    Menu?    @relation("SubMenus", fields: [parentId], references: [id])
  children  Menu[]   @relation("SubMenus")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum MenuType {
  HEADER
  FOOTER
  SIDEBAR
}

model FooterInfo {
  id    String         @id @default(cuid())
  label String
  value String
  type  FooterInfoType // CONTACT, SOCIAL, LEGAL, etc
  icon  String?
  order Int
}

enum FooterInfoType {
  CONTACT
  SOCIAL
  LEGAL
  CUSTOM
}

model Benefit {
  id          String           @id @default(cuid())
  title       String // Misal: "Buku Panduan"
  description String? // Penjelasan tambahan
  icon        String? // Opsional, bisa URL atau nama icon
  products    ProductBenefit[] // Relasi ke produk melalui ProductBenefit
}

model ProductGallery {
  id        String   @id @default(cuid())
  product   Product  @relation(fields: [productId], references: [id])
  productId String
  imageUrl  String // URL gambar produk
  order     Int // Urutan gambar dalam galeri
  createdAt DateTime @default(now())
}

model ProductBenefit {
  id        String  @id @default(cuid())
  product   Product @relation(fields: [productId], references: [id])
  productId String
  benefit   Benefit @relation(fields: [benefitId], references: [id])
  benefitId String
  isActive  Boolean @default(true) // Status aktif atau tidak aktif
}

model ProductBenefitPoint {
  id        String  @id @default(cuid())
  product   Product @relation(fields: [productId], references: [id])
  productId String
  text      String // manfaat yang ditampilkan
  order     Int // untuk urutan tampilan
  icon      String? // optional, jika ingin pakai icon/emoji
}

model Promotion {
  id          String    @id @default(cuid())
  name        String // nama promo
  description String? // penjelasan promo
  type        PromoType // diskon, bonus, dll
  value       Float? // contoh: 10 (10%) atau 50000 (Rp50rb)
  isActive    Boolean   @default(true)
  startDate   DateTime
  endDate     DateTime
  products    Product[] @relation("ProductPromotions")
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

enum PromoType {
  PERCENTAGE // Diskon persen (%)
  FIXED // Potongan harga tetap (Rp)
  BONUS_ITEM // Bonus item
  FREE_SHIPPING // Gratis ongkir
  CUSTOM // Bebas, bisa deskripsi sendiri
}

model Voucher {
  id          String         @id @default(cuid())
  code        String         @unique
  description String?
  type        PromoType
  value       Float
  usageLimit  Int?
  usedCount   Int            @default(0)
  isActive    Boolean        @default(true)
  startDate   DateTime
  endDate     DateTime
  products    Product[]      @relation("VoucherProducts")
  usages      VoucherUsage[] // ✅ ini tambahan penting!
  orders      Order[]
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}

model VoucherUsage {
  id        String   @id @default(cuid())
  voucher   Voucher  @relation(fields: [voucherId], references: [id])
  voucherId String
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  usedAt    DateTime @default(now())

  @@unique([voucherId, userId]) // ✅ 1 user tidak bisa pakai voucher yang sama 2x
}

model User {
  id            String         @id @default(cuid())
  name          String?
  email         String?        @unique
  emailVerified DateTime?
  image         String?
  role          UserRole       @default(CUSTOMER)
  orders        Order[]
  accounts      Account[]
  sessions      Session[]
  vouchers      VoucherUsage[] // tetap bisa dipakai seperti biasa

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id])

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  user         User     @relation(fields: [userId], references: [id])
  expires      DateTime
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

enum UserRole {
  CUSTOMER
  ADMIN
}

model Order {
  id         String      @id @default(cuid())
  email      String // email pembeli (guest atau login)
  name       String? // nama pembeli (optional)
  user       User?       @relation(fields: [userId], references: [id])
  userId     String?
  products   Product[]   @relation("OrderProducts")
  voucher    Voucher?    @relation(fields: [voucherId], references: [id])
  voucherId  String?
  totalPrice Float
  status     OrderStatus @default(PENDING)
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

enum OrderStatus {
  PENDING
  PAID
  SHIPPED
  COMPLETED
  CANCELLED
}

//npx prisma migrate dev   
//npx prisma generate
//npx prisma studio
